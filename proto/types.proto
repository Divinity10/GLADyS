syntax = "proto3";

package gladys.types;

// ============================================================================
// SHARED TYPES - Cross-service boundary types
// ============================================================================
//
// PRINCIPLE: If a type is CREATED by service A and CONSUMED by service B,
// it belongs here. This prevents class mismatch errors when copying between
// proto messages from different packages.

// Salience assessment for event evaluation.
// Used in both Event (orchestrator routing) and EpisodicEvent (memory storage).
//
// Design: docs/design/SALIENCE_MODEL.md (finalized 2026-02-11)
// - 3 scalars: threat (bypass), salience (priority), habituation (suppression)
// - Vector: extensible map for response-shaping dimensions
// - Standard dimensions: novelty, goal_relevance, opportunity, actionability, social
// - Sensors can populate threat + limited vector fields; system computes salience scalar
message SalienceResult {
    // Scalars (routing/filtering)
    float threat = 1;               // 0-1: Interrupt signal, bypasses queue + habituation
    float salience = 2;             // 0-1: Queue priority (computed from vector via weighted sum)
    float habituation = 3;          // 0-1: Temporal suppression (0=fresh, 1=fully habituated)

    // Vector (response-shaping dimensions, extensible)
    // Standard dimensions: novelty, goal_relevance, opportunity, actionability, social
    // Models/sensors can add custom dimensions as needed
    map<string, float> vector = 4;  // dimension_name -> value (0-1 range)

    // Metadata
    string model_id = 5;            // Which model/sensor populated this (e.g., "security_sensor_v1", "heuristic_boost_v2")
}

// ============================================================================
// HEALTH CHECK - Shared health messages for all services
// ============================================================================

enum HealthStatus {
    HEALTH_STATUS_UNKNOWN = 0;
    HEALTH_STATUS_HEALTHY = 1;
    HEALTH_STATUS_UNHEALTHY = 2;
    HEALTH_STATUS_DEGRADED = 3;     // Partially functional
}

message GetHealthRequest {}

message GetHealthResponse {
    HealthStatus status = 1;
    string message = 2;             // Optional: reason for status
}

message GetHealthDetailsRequest {}

message GetHealthDetailsResponse {
    HealthStatus status = 1;
    int64 uptime_seconds = 2;
    map<string, string> details = 3;  // Service-specific key-value pairs
}
